


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta content="Model, finance, Heston, Stochastic, PED" name="keywords" />
<meta content="Heston model is a mathematical model that describing dynamics of underlying asset price." name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />

		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../_static/js/jquery.min.js"></script>	
	  <script type="text/javascript" src="../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../_static/js/common-ui-all.min.js"></script>		
    <script type="text/javascript" src="../_static/js/header-footer.min.js"></script>	
    <script type="text/javascript" src="../_static/js/jquery-ui.min.js"></script>	
    <script type="text/javascript" src="../_static/js/CoveoJsSearch.Lazy.min.js"></script>	
    <script type="text/javascript" src="../_static/js/linkid.js"></script>		
    <script type="text/javascript" src="../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hull-White Model" href="HW.html" />
    <link rel="prev" title="Black-Scholes Model" href="BS.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search" 
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a> 
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a> 
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search" 
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Quantitative Finance Library
          

          
          </a>

          
            
            
              <div class="version">
                2019.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rel.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../models_and_methods.html">Pricing Models and Numerical Methods</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../models_and_methods.html#models">Models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="BS.html">Black-Scholes Model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Heston Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stochastic-process-equations-of-the-heston-model">Stochastic Process Equations of the Heston Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partial-differential-equation-ped-of-heston-model">Partial Differential Equation (PED) of Heston Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementations">Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="HW.html">Hull-White Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="BK.html">Black-Karasinski Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="CIR.html">Cox-Ingersoll-Ross Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="ECIR.html">Extended Cox-Ingersoll-Ross Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="V.html">Vasicek Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="G2.html">G2 Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models_and_methods.html#numerical-methods">Numerical Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models_and_methods.html#closed-form-solution-methods">Closed-Form Solution Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L1/L1.html">L1 Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L2/L2.html">L2 Kernel User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L3/L3.html">L3 Overlay User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/benchmark.html">Quality and Performance</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vitis Quantitative Finance Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../models_and_methods.html">Pricing Models and Numerical Methods</a> &raquo;</li>
        
      <li>Heston Model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="heston-model">
<h1>Heston Model<a class="headerlink" href="#heston-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Heston model is a mathematical model that describing dynamics of underlying asset price.
It is a stochastic volatility model which assumes the volatility of the asset price is not constant but follows a random process.
In this case, volatility follows square root process which means volatility is always non-negative.</p>
</div>
<div class="section" id="stochastic-process-equations-of-the-heston-model">
<h2>Stochastic Process Equations of the Heston Model<a class="headerlink" href="#stochastic-process-equations-of-the-heston-model" title="Permalink to this headline">¶</a></h2>
<p>The continuous form of Heston Model is:</p>
<div class="math notranslate nohighlight">
\[\mathrm{d} S_t = \mu S_t \mathrm{d}t + \sqrt[2]{\nu} S_t \mathrm{d}W_t^S\]</div>
<div class="math notranslate nohighlight">
\[\mathrm{d} \nu_t = \kappa (\theta - \nu_t) \mathrm{d}t + \sigma \sqrt[2]{\nu_t} \mathrm{d}W_t^\nu\]</div>
<div class="math notranslate nohighlight">
\[Corr(W_t^S, W_t^\nu)) = \rho\]</div>
<p>Where <span class="math notranslate nohighlight">\(S_t\)</span> is random variable, represent a stock price at time <span class="math notranslate nohighlight">\(t\)</span>.
<span class="math notranslate nohighlight">\(\mu\)</span> is the stock’s expected rate of return.
<span class="math notranslate nohighlight">\(\sqrt[2]{\nu_t}\)</span> is the volatility of stock price and <span class="math notranslate nohighlight">\(\nu_t\)</span> is also a random variable.
<span class="math notranslate nohighlight">\(\theta\)</span> is the long term variance.
<span class="math notranslate nohighlight">\(\kappa\)</span> is the rate at which <span class="math notranslate nohighlight">\(\nu_t\)</span> revert to <span class="math notranslate nohighlight">\(\theta\)</span>.
<span class="math notranslate nohighlight">\(\sigma\)</span> is the volatility of the volatility.
<span class="math notranslate nohighlight">\(\mathrm{d}W_t^S\)</span> and <span class="math notranslate nohighlight">\(\mathrm{d}W_t^\nu\)</span> are Wiener processes with correlation <span class="math notranslate nohighlight">\(\rho\)</span>.</p>
</div>
<div class="section" id="partial-differential-equation-ped-of-heston-model">
<h2>Partial Differential Equation (PED) of Heston Model<a class="headerlink" href="#partial-differential-equation-ped-of-heston-model" title="Permalink to this headline">¶</a></h2>
<p>In the provided solver, the PDE is the Heston Pricing Model <a class="reference internal" href="#heston1993" id="id1">[HESTON1993]</a>. Using the naming conventions of Hout &amp; Foulon <a class="reference internal" href="#hout2010" id="id2">[HOUT2010]</a>, the PDE is given as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial u}{\partial t} = \tfrac{1}{2}s^2v\frac{\partial^{2} u}{\partial s^2} + \rho\sigma sv\frac{\partial^{2} u}{\partial s\partial v} + \tfrac{1}{2}\sigma^2v\frac{\partial^{2} u}{\partial v^2} + (r_d - r_f)s\frac{\partial u}{\partial s} + \kappa(\eta - v)\frac{\partial u}{\partial v} - r_d u\]</div>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(u\)</span> - the price of the European option;</p>
<p><span class="math notranslate nohighlight">\(s\)</span> - the underlying price of the asset;</p>
<p><span class="math notranslate nohighlight">\(v\)</span> - the volatility of the underlying price;</p>
<p><span class="math notranslate nohighlight">\(\sigma\)</span> - the volatility of the volatility;</p>
<p><span class="math notranslate nohighlight">\(\rho\)</span> - the correlation of Weiner processes;</p>
<p><span class="math notranslate nohighlight">\(\kappa\)</span> - the mean-reversion rate;</p>
<p><span class="math notranslate nohighlight">\(\eta\)</span> - the long term mean.</p>
<p>The Heston PDE then describes the evolution of an option price over time (<span class="math notranslate nohighlight">\(t\)</span>) and a solution of this PDE results in the specific option price for an <span class="math notranslate nohighlight">\((s,v)\)</span> pair for a given maturity date <span class="math notranslate nohighlight">\(T\)</span>. The finite difference solver maps the <span class="math notranslate nohighlight">\((s,v)\)</span> pair onto a 2D discrete grid, and solves for option price <span class="math notranslate nohighlight">\(u(s,v)\)</span> after <span class="math notranslate nohighlight">\(N\)</span> time-steps.</p>
</div>
<div class="section" id="implementations">
<h2>Implementations<a class="headerlink" href="#implementations" title="Permalink to this headline">¶</a></h2>
<p>The discrete form (Euler-Maruyama Form) of Heston Model is:</p>
<div class="math notranslate nohighlight">
\[\ln{S(j\Delta)} = \ln{S((j-1)\Delta)} + \mu\Delta + \sqrt[2]{\nu((j-1)\Delta)} \Delta W_t^S\]</div>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = \nu((j-1)\Delta) + \kappa(\theta - \nu((j-1)\Delta))\Delta + \sigma\sqrt[2]{\nu((j-1)\Delta)}\Delta W_t^\nu\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Delta\)</span> stands for unit timestep length.
<span class="math notranslate nohighlight">\(S(j\Delta)\)</span> stands for S in j th timesteps, AKA <span class="math notranslate nohighlight">\(S(j * \Delta t)\)</span>.
<span class="math notranslate nohighlight">\(\nu(j\Delta)\)</span> has a similar meaning.
To simplify the process, we use <span class="math notranslate nohighlight">\(\ln{S(j\Delta)}\)</span> instead of <span class="math notranslate nohighlight">\(S\)</span> since multiplication becomes addition after logarithm.</p>
<p><span class="math notranslate nohighlight">\(\Delta W_t^S\)</span> and <span class="math notranslate nohighlight">\(\Delta W_t^\nu\)</span> could be calculated by:</p>
<div class="math notranslate nohighlight">
\[\Delta W_t^S = \Delta Z_S\]</div>
<div class="math notranslate nohighlight">
\[\Delta W_t^\nu = \Delta Z_\nu\]</div>
<p>Where <span class="math notranslate nohighlight">\(Z_S\)</span> and <span class="math notranslate nohighlight">\(Z_\nu\)</span> are two uniform distributed random numbers that have correlation <span class="math notranslate nohighlight">\(\rho\)</span></p>
<p>Although <span class="math notranslate nohighlight">\(\nu\)</span> is non-negative in continuous form, it would become negative if we use the Euler-Maruyama form above directly.
There are several variations to solve this issue, here we provide 5 of most commonly used.</p>
<p><strong>kDTReflection</strong>: use absolute value of the volatility of the last iteration.</p>
<div class="math notranslate nohighlight">
\[\ln{S(j\Delta)} = \ln{S((j-1)\Delta)} + \mu\Delta + \sqrt[2]{|\nu((j-1)\Delta)|} \Delta W_t^S\]</div>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = |\nu((j-1)\Delta)| + \kappa(\theta - |\nu((j-1)\Delta)|)\Delta + \sigma\sqrt[2]{|\nu((j-1)\Delta)|}\Delta W_t^\nu\]</div>
<p><strong>kDTPartialTruncation</strong>: use only absolute value of volatility of the last iteration in sqrt root part.</p>
<div class="math notranslate nohighlight">
\[\ln{S(j\Delta)} = \ln{S((j-1)\Delta)} + \mu\Delta + \sqrt[2]{|\nu((j-1)\Delta)|} \Delta W_t^S\]</div>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = \nu((j-1)\Delta) + \kappa(\theta - \nu((j-1)\Delta))\Delta + \sigma\sqrt[2]{|\nu((j-1)\Delta)|}\Delta W_t^\nu\]</div>
<p><strong>kDTFullTruncation</strong>: use only positive part or zero of volatility of the last iteration.</p>
<p><span class="math notranslate nohighlight">\(\nu((j-1)\Delta)^+ = \nu((j-1)\Delta)\)</span> if <span class="math notranslate nohighlight">\(\nu((j-1)\Delta) &gt; 0\)</span> <span class="math notranslate nohighlight">\(\nu((j-1)\Delta)^+ = 0\)</span> if <span class="math notranslate nohighlight">\(\nu((j-1)\Delta) \leq 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\ln{S(j\Delta)} = \ln{S((j-1)\Delta)} + \mu\Delta + \sqrt[2]{\nu((j-1)\Delta)^+} \Delta W_t^S\]</div>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = \nu((j-1)\Delta) + \kappa(\theta - \nu((j-1)\Delta)^+)\Delta + \sigma\sqrt[2]{\nu((j-1)\Delta)^+}\Delta W_t^\nu\]</div>
<p><strong>kDTQuadraticExponential</strong> and <strong>kDTQuadraticExponentialMartingale</strong> are more accurate variation, details could be found in reference papers <a class="reference internal" href="#anderson2005" id="id3">[ANDERSON2005]</a>.
They use a different approximation method to calculate <span class="math notranslate nohighlight">\(\nu\)</span>, here’s brief on its algorithm</p>
<p>Step 1: we calculate first order moment and second order moment of <span class="math notranslate nohighlight">\(\nu\)</span>.</p>
<div class="math notranslate nohighlight">
\[m = \theta + (\nu((j-1)\Delta) - \theta)e^{-\kappa \theta}\]</div>
<div class="math notranslate nohighlight">
\[s^2 = \frac{\nu((j-1)\Delta)\sigma^2 e^{-\kappa \Delta} }{\kappa} (1 - e^{-\kappa \Delta}) + \frac{\theta \sigma^2}{2 \kappa}(1 - e^{-\kappa \Delta})^2\]</div>
<p>Step 2: Calculate <span class="math notranslate nohighlight">\(\Psi = s^2 / m^2\)</span></p>
<p>Step 3: If <span class="math notranslate nohighlight">\(\Psi \leq \Psi_{sw}, \Psi_{sw} = 1.5\)</span>, Then</p>
<p>Step 3.1: Calculate <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b^2\)</span></p>
<div class="math notranslate nohighlight">
\[b^2 = 2\Psi^{-1} - 1 + \sqrt[2]{2\Psi^{-1}} \sqrt[2]{2\Psi^{-1}-1}\]</div>
<div class="math notranslate nohighlight">
\[a = \frac{m}{1+b^2}\]</div>
<p>Step 3.2: Calculate <span class="math notranslate nohighlight">\(\nu(j\Delta)\)</span></p>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = a(b+Z_\nu)^2\]</div>
<p>Step 4: If Step 3 does not hold, Then</p>
<p>Step 4.1: Calculate <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(p\)</span></p>
<div class="math notranslate nohighlight">
\[p = \frac{\Psi - 1}{\Psi + 1}\]</div>
<div class="math notranslate nohighlight">
\[\beta = \frac{2}{m(\Psi + 1)}\]</div>
<p>Step 4.2: Calculate <span class="math notranslate nohighlight">\(U_\nu = \Psi(Z_\nu)\)</span></p>
<p>Step 4.3: Calculate <span class="math notranslate nohighlight">\(\nu(j\Delta)\)</span></p>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = 0 \:\: if \:\: U_\nu \leq p\]</div>
<div class="math notranslate nohighlight">
\[\nu(j\Delta) = \frac{1}{\beta}(\frac{\log{(1-p)}}{1-U_\nu}) \:\: if \:\:  p &lt; U_\nu\]</div>
<p>It should be noticed that they both have two branches for value in different range.
These two branches have a similar calculation process.
Furthermore, only one branch is active at the same time.
By merging these two branches into one branch and manually binding calculations to DSPs, it will cut off DSP cost.
This won’t change its performance and accuracy.</p>
<p>In Monte Carlo Simulation, we need to compute stock prices of multiple paths at multiple time steps.
Therefore we need two loops to calculate prices and volatilities, the inner loop is either timestep loop or path loop.
Price at each time step is calculated using last time step’s price and volatility as input.
And we use 1-D array to store price and volatility of each path’s history (last timestep).</p>
<p>If the inner loop is timestep loop, as red arrows demonstrate in the diagram below, it will keep update the same array element until reaches max timesteps.
Such operation can not achieve initiation interval (II)=1 and will greatly slow down the calculation process.
If the inner loop is path loop, as green arrows demonstrate in the diagram below, it will keep updating different array element each time.
Such operation will avoid dependency issue and reach II=1, which is used in this implementation.</p>
<a class="reference internal image-reference" href="../_images/inner_loop.png"><img alt="Inner Loop of timesteps and path" class="align-center" src="../_images/inner_loop.png" style="width: 80%;" /></a>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="heston1993" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[HESTON1993]</a></td><td>Heston, “A closed-form solution for options with stochastic volatility with applications to bond and currency options”, Rev. Finan. Stud. Vol. 6 (1993)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hout2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[HOUT2010]</a></td><td>Hout and Foulon, “ADI Finite Difference Schemes for Option Pricing in the Heston Model with correlation”, International Journal of Numerical Analysis and Modeling, Vol 7, Number 2 (2010).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="anderson2005" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[ANDERSON2005]</a></td><td>Anderson, L, “Efficient Simulation of the Heston Stochastic Volatility Model”, (2005).</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>
	  
	  
	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="HW.html" class="btn btn-neutral float-right" title="Hull-White Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="BS.html" class="btn btn-neutral float-left" title="Black-Scholes Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
  </div>	  
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
  

  
  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2019, Xilinx
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}
			
			underscoreSetup();
		</script>
	</body>
</html>